<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PCBS">
<title>Manipulating Percent Methylation â€¢ PCBS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Manipulating Percent Methylation">
<meta property="og:description" content="PCBS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PCBS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Differential_Methylation.html">Differential Methylation with PCBS</a>
    <a class="dropdown-item" href="../articles/Manipulating_Percent_Methylation.html">Manipulating Percent Methylation</a>
    <a class="dropdown-item" href="../articles/Optimizing_DMR_Calling.html">Optimizing DMR Calling</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/katlande/PCBS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Manipulating Percent Methylation</h1>
                        <h4 data-toc-skip class="author">Kathryn
Lande</h4>
            
            <h4 data-toc-skip class="date">2024-08-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/katlande/PCBS/blob/HEAD/vignettes/Manipulating_Percent_Methylation.Rmd" class="external-link"><code>vignettes/Manipulating_Percent_Methylation.Rmd</code></a></small>
      <div class="d-none name"><code>Manipulating_Percent_Methylation.Rmd</code></div>
    </div>

    
    
<p>While PCBS functions on eigenvector scores internally, users may wish
to generate plots using less esoteric values, such as the mean percent
methylation difference between conditions. Here we provide a brief
tutorial for this type of analysis.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/katlande/PCBS" class="external-link">PCBS</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="generating-a-chromdict">Generating a chromDict<a class="anchor" aria-label="anchor" href="#generating-a-chromdict"></a>
</h2>
<p>chromDicts are lists of keyed data.tables that enable very fast
computing times. chromDicts of eigenvector score are used internally by
many PCBS functions. They can also be explicitly generated by users who
wish to speed up iterative function calls. In order to easily manipulate
our percent methylation values genome-wide, we can make a percent
methylation chromDict object that holds the average percent methylation
difference between two treatments for all filtered loci.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chromDictMethylDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/chromDictMeth.html">chromDictMeth</a></span><span class="op">(</span><span class="va">eigen</span>, IDs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trt"</span>, <span class="st">"ctl"</span><span class="op">)</span>, filter_thresh <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quantifying-the-mean-methylation-difference-across-a-region">Quantifying the mean methylation difference across a region<a class="anchor" aria-label="anchor" href="#quantifying-the-mean-methylation-difference-across-a-region"></a>
</h2>
<p>Once the chromDictMeth object is generated, methylation at a region
or over a set of regions can be computed very quickly.</p>
<p>Get the methylation difference across one known DMR:</p>
<pre><code><span><span class="co">## [1] -0.5493768</span></span></code></pre>
<p>Or get the methylation difference across a set of regions:</p>
<pre><code><span><span class="co">##    chr       s       e mean_methylDiff</span></span>
<span><span class="co">## 1 chr3 4920450 4923267     -0.54937676</span></span>
<span><span class="co">## 2 chr3 3961576 3963805      0.21200740</span></span>
<span><span class="co">## 3 chr1  300000  302900     -0.09435562</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="metagenes-using-percent-methylation-difference">Metagenes using percent methylation difference<a class="anchor" aria-label="anchor" href="#metagenes-using-percent-methylation-difference"></a>
</h2>
<p>Like the score_metagene() function, PCBS can also generate metagenes
on percent methylation using a chromDictMeth object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/methylDiff_metagene.html">methylDiff_metagene</a></span><span class="op">(</span><span class="va">chromDictMethylDiff</span>, <span class="va">regions</span><span class="op">)</span></span></code></pre></div>
<p><img src="Manipulating_Percent_Methylation_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Just like score-based metagenes, you can save the data from a
methylDiff_metagene() function and overlay multiple metagenes on a
single plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Some hypermethylated sites:</span></span>
<span><span class="va">hyper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>c<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr3"</span><span class="op">)</span>,</span>
<span>                    s<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8650728</span>, <span class="fl">3960576</span><span class="op">)</span>,</span>
<span>                    e<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8652017</span>, <span class="fl">3962805</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Some hypomethylated sites:</span></span>
<span><span class="va">hypo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>c<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr3"</span>, <span class="st">"chr3"</span>, <span class="st">"chr3"</span><span class="op">)</span>,</span>
<span>                   s<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4920450</span>, <span class="fl">4140014</span>, <span class="fl">1340221</span><span class="op">)</span>,</span>
<span>                   e<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4923267</span>, <span class="fl">4142951</span>, <span class="fl">1342791</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">metagene_hyper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/methylDiff_metagene.html">methylDiff_metagene</a></span><span class="op">(</span><span class="va">chromDictMethylDiff</span>, <span class="va">hypo</span>, return.data <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">metagene_hypo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/methylDiff_metagene.html">methylDiff_metagene</a></span><span class="op">(</span><span class="va">chromDictMethylDiff</span>, <span class="va">hyper</span>, return.data <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/multiple_metagenes.html">multiple_metagenes</a></span><span class="op">(</span>data_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">metagene_hyper</span>, <span class="va">metagene_hypo</span><span class="op">)</span>, <span class="co"># list of raw data</span></span>
<span>                   set_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hyper DMRs"</span>, <span class="st">"Hypo DMRs"</span><span class="op">)</span>, <span class="co"># names for elements of the data_list list</span></span>
<span>                   title<span class="op">=</span><span class="st">"Metagenes of DMR Regions"</span>, legend.title <span class="op">=</span> <span class="cn">F</span>, </span>
<span>                   yaxis <span class="op">=</span> <span class="st">"Mean Methylation Difference"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Manipulating_Percent_Methylation_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kathryn Lande.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
